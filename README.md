# Rendered Manifests

**âš ï¸ This repository is AUTO-GENERATED by CI/CD. DO NOT EDIT MANUALLY.**

## ğŸ¯ Purpose

This repository contains fully rendered Kubernetes manifests that ArgoCD watches and deploys to clusters.

## ğŸ”„ How It Works

```
1. Service code push â†’ GitHub Actions
2. Build Docker image â†’ Push to Artifact Registry
3. Render: helm-templates + helm-values + image tag â†’ This repo
4. ArgoCD watches this repo â†’ Syncs to K8s cluster
```

## ğŸ“ Structure

```
rendered-manifests/
â”œâ”€â”€ dev/
â”‚   â”œâ”€â”€ recording-webhook/
â”‚   â”‚   â”œâ”€â”€ deployment.yaml          # Auto-generated
â”‚   â”‚   â”œâ”€â”€ service.yaml             # Auto-generated
â”‚   â”‚   â”œâ”€â”€ ingress.yaml             # Auto-generated
â”‚   â”‚   â”œâ”€â”€ hpa.yaml                 # Auto-generated
â”‚   â”‚   â””â”€â”€ ...
â”‚   â””â”€â”€ transcriber/
â”‚       â””â”€â”€ *.yaml
â”‚
â”œâ”€â”€ prod/
â”‚   â”œâ”€â”€ recording-webhook/
â”‚   â”‚   â””â”€â”€ *.yaml
â”‚   â””â”€â”€ ...
â”‚
â””â”€â”€ dynamic/
    â”œâ”€â”€ recording-webhook-pr-123/
    â”‚   â””â”€â”€ *.yaml                   # Auto-created for PRs
    â””â”€â”€ ...
```

## ğŸ“ Manifest Format

Each manifest file has auto-generated metadata:

```yaml
# ğŸ¤– AUTO-GENERATED - DO NOT EDIT MANUALLY
# Generated by: GitHub Actions
# Service: recording-webhook
# Environment: dev
# Image Version: main-abc123
# Helm Templates: v1.0.0
# Generated: 2025-11-04 12:00:00 UTC
# Commit: abc123def456
# Workflow: https://github.com/ritual-app/recording-webhook/actions/runs/12345
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: recording-webhook
  namespace: dev
...
```

## ğŸš« Do Not Edit

**This repo is the single source of truth for ArgoCD.**

- âŒ Do NOT edit files here manually
- âŒ Do NOT create PRs to this repo
- âœ… Edit `helm-values` to change configuration
- âœ… Edit `helm-templates` to change templates
- âœ… CI/CD will re-render and push here automatically

## ğŸ” Troubleshooting

### "My changes aren't deploying"

1. Check if CI/CD workflow succeeded
2. Check if rendered manifests were pushed here
3. Check ArgoCD Application status
4. Check ArgoCD sync status

### "Manifests look wrong"

1. Check `helm-values` for the service
2. Check `helm-templates` version being used
3. Check CI/CD logs for rendering errors
4. Test rendering locally:
   ```bash
   helm template my-service helm-templates/dev \
     --values helm-values/dev/my-service/values.yaml \
     --set image.tag=test \
     --debug
   ```

## ğŸ—‘ï¸ Cleanup

Dynamic environments (PRs) are auto-cleaned up:
- When PR is closed/merged
- After 7 days of inactivity
- Manual cleanup via workflow

## ğŸ”— Related Repositories

- **helm-templates**: Generic Helm templates
- **helm-values**: Service-specific configuration
- **shared-workflows**: CI/CD that generates these manifests

## ğŸ“Š Git History

Each commit represents a deployment:
```
ğŸš€ Deploy recording-webhook to dev: main-abc123
ğŸš€ Render transcriber prod: v1.2.3
ğŸ§¹ Cleanup dynamic environment: pr-456
```

## ğŸ” ArgoCD Access

ArgoCD Applications watch specific paths:
- `recording-webhook-dev` â†’ `dev/recording-webhook/`
- `recording-webhook-prod` â†’ `prod/recording-webhook/`
- `recording-webhook-pr-123` â†’ `dynamic/recording-webhook-pr-123/`

## ğŸ“ˆ Monitoring

- Commits to this repo = deployments
- Use GitHub Actions logs for CI/CD details
- Use ArgoCD UI for K8s deployment status

---

**âš ï¸ REMINDER: This repo is read-only for humans. CI/CD only!**

